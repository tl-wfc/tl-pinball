#config_version=6

mode:
  start_events: ball_starting
  stop_events: ball_will_end
  priority: 100

# Keep scoring in a separate yaml file
config:
  - base_points.yaml

# -------------------------
# EVENTS
# -------------------------
event_player:
  # make sure spinner_2x is off at ball start
  mode_base_started: spinner_2x_stop

  # Toggle A
  s_62_top_lane_a_active{current_player.top_lane_a_lit == 0}: top_lane_a_turn_on
  s_62_top_lane_a_active{current_player.top_lane_a_lit == 1}: top_lane_a_turn_off

  # Toggle B
  s_61_top_lane_b_active{current_player.top_lane_b_lit == 0}: top_lane_b_turn_on
  s_61_top_lane_b_active{current_player.top_lane_b_lit == 1}: top_lane_b_turn_off

  # Toggle C
  s_60_top_lane_c_active{current_player.top_lane_c_lit == 0}: top_lane_c_turn_on
  s_60_top_lane_c_active{current_player.top_lane_c_lit == 1}: top_lane_c_turn_off

  # After any toggle change, re-check qualification
  top_lane_a_turn_on: top_lanes_check
  top_lane_a_turn_off: top_lanes_check
  top_lane_b_turn_on: top_lanes_check
  top_lane_b_turn_off: top_lanes_check
  top_lane_c_turn_on: top_lanes_check
  top_lane_c_turn_off: top_lanes_check

  # Start/stop spinner_2x based on whether all 3 are lit
  top_lanes_check{(current_player.top_lane_a_lit == 1) and (current_player.top_lane_b_lit == 1) and (current_player.top_lane_c_lit == 1)}: spinner_2x_start
  top_lanes_check{not ((current_player.top_lane_a_lit == 1) and (current_player.top_lane_b_lit == 1) and (current_player.top_lane_c_lit == 1))}: spinner_2x_stop

# -------------------------
# VARIABLES (ONLY ONE BLOCK)
# -------------------------
variable_player:
  # Per-ball reset of lane state
  mode_base_started:
    top_lane_a_lit:
      action: set
      int: 0
    top_lane_b_lit:
      action: set
      int: 0
    top_lane_c_lit:
      action: set
      int: 0

  # Toggle actions
  top_lane_a_turn_on:
    top_lane_a_lit:
      action: set
      int: 1
  top_lane_a_turn_off:
    top_lane_a_lit:
      action: set
      int: 0

  top_lane_b_turn_on:
    top_lane_b_lit:
      action: set
      int: 1
  top_lane_b_turn_off:
    top_lane_b_lit:
      action: set
      int: 0

  top_lane_c_turn_on:
    top_lane_c_lit:
      action: set
      int: 1
  top_lane_c_turn_off:
    top_lane_c_lit:
      action: set
      int: 0
